<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pg_ask - PostgreSQL AI Extension</title>
    <style>
      body { font-family: system-ui; max-width: 800px; margin: 2rem auto; padding: 0 1rem; }
      .section { margin: 2rem 0; }
      .platform { border: 1px solid #ddd; padding: 1rem; margin: 1rem 0; border-radius: 4px; }
      .file { margin: 0.5rem 0; }
      .file-icon { margin-right: 0.5rem; }
      pre { background: #f5f5f5; padding: 1rem; border-radius: 4px; overflow-x: auto; }
      footer { margin-top: 3rem; padding-top: 1rem; border-top: 1px solid #ddd; color: #666; }
    </style>
</head>
<body>
    <h1>pg_ask - PostgreSQL AI Extension</h1>
    <p>Repository: <a href="https://github.com/abiji-2020/pg_ask">abiji-2020/pg_ask</a></p>
    
    <div class="section">
      <h2>ðŸš€ Quick Install</h2>
      <pre><code>curl -sSL https://abiji-2020.github.io/pg_ask/install.sh | bash</code></pre>
    </div>
    
    <div class="section">
      <h2>ðŸ“¥ Available Builds</h2>
      <div id="releases"></div>
    </div>
    
    <footer>
      Latest release: <strong id="version">loading...</strong> | 
      <a href="https://github.com/abiji-2020/pg_ask">View on GitHub</a>
    </footer>
    
    <script>
      function formatBytes(bytes) {
        if (bytes === 0) return '0 Bytes';
        const k = 1024;
        const sizes = ['Bytes', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];
      }

      fetch('https://abiji-2020.github.io/pg_ask/manifest.json')
        .then(r => r.json())
        .then(data => {
          document.getElementById('version').textContent = data.version || 'unknown';
          
          const releasesDiv = document.getElementById('releases');
          if (!data.releases || Object.keys(data.releases).length === 0) {
            releasesDiv.innerHTML = '<p>No releases available yet.</p>';
            return;
          }
          
          const html = Object.entries(data.releases).map(([arch, files]) => `
            <div class="platform">
              <h3>${arch}</h3>
              ${files.map(f => `
                <div class="file">
                  <span class="file-icon">ðŸ“¦</span>
                  <a href="${f.url}">${f.name}</a>
                  ${f.size ? `<span style="color: #666; font-size: 0.9em; margin-left: 0.5rem;">(${formatBytes(f.size)})</span>` : ''}
                </div>
              `).join('')}
            </div>
          `).join('');
          releasesDiv.innerHTML = html;
        })
        .catch(e => {
          console.error('Failed to load releases:', e);
          document.getElementById('releases').innerHTML = '<p>Failed to load releases.</p>';
        });
    </script>
</body>
</html>
